XIAOMI.namespace("goodsComments"),XIAOMI.goodsComments={config:function(){var a=this;a.comment_url=XIAOMI.GLOBAL_CONFIG.commentUrl+"/",a.comment_url_list=XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/getList?",a.comment_replay_url=XIAOMI.GLOBAL_CONFIG.orderSite+"/comment/commentReplyList",a.question_url=XIAOMI.GLOBAL_CONFIG.askApiUrl+"/ask/askList?",a.login_comment_url=XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/",a.question_add=XIAOMI.GLOBAL_CONFIG.askApiUrl+"/ask/addAsk?",a.comment_reply_add_url=XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/reply?",a.comment_list_byUser=XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/getCommentList?",a.listdefaults={pageAmount:5,orderBy:0,pageNum:1,comment_grade:0,ProductId:0},a.comment_detail_url=""},jsonP:function(a,b){$.ajax({type:"GET",url:a.url,dataType:"jsonp",jsonp:"jsonpcallback",success:function(c){b(c,a)}})},init:function(){var a=this;a.config()},dotmpl:function(a,b){var c=a.html(),d=doT.template(c);return d(b)},showCommentList:function(a,b){var c=this;options=$.extend({},c.listdefaults,a);var d={},e=a.ProductId;d.url=c.comment_url+"comment/vlist/goods_id/"+e+"/pagesize/"+options.pageAmount+"/pageindex/"+options.pageNum+"/comment_grade/"+options.comment_grade+"/orderby/"+options.orderBy+"/cnum/0",$.ajax({type:"GET",url:d.url,dataType:"jsonp",jsonpCallback:"commentList",cache:!0,success:function(c){b(c,a)}})},showCommentList_b:function(a,b){var c=this;options=$.extend({},c.listdefaults,a);var d={},e=a.ProductId;d.url=c.comment_url_list+"goods_id="+e+"&pagesize="+options.pageAmount+"&pageindex="+options.pageNum+"&orderby="+options.orderBy,$.ajax({type:"GET",url:d.url,dataType:"jsonp",jsonpCallback:"commentList",cache:!0,success:function(c){b(c,a)}})},getCommentReplay:function(a,b){var c=this,d=a.commentId,e=a.pageindex,f=a.pagesize,g={};g.url=c.comment_replay_url+"/comment_id/"+d+"/pagesize/"+f+"/pageindex/"+e,$.ajax({type:"GET",url:g.url,dataType:"jsonp",jsonpCallback:"commentReplyList",cache:!0,success:function(c){b(c,a)}})},getQuestionList:function(a,b){var c=this,d=a.ProductId,e=a.pageIndex,f=a.pagesize,g={};g.url=c.question_url+"product_id="+d+"&pageindex="+e+"&ask_mode=ask&pagesize="+f,c.jsonP(g,b)},askQuestion:function(a,b){var c=this,d=a.content,e=a.ProductId,f=goodsConfig.GoodsId,g=XIAOMI.app.cookie("userId"),h=encodeURIComponent(XIAOMI.app.cookie("XM_"+g+"_UN")),i={};i.url=c.question_add+"product_id="+e+"&ask_mode=ask&content="+d+"&cid="+f+"&user_name="+h,c.jsonP(i,b)},addReply:function(a,b){var c=this,d=a.commentId,e=a.parent_id,f=a.content,g=a.user_id,h={};h.url=c.comment_reply_add_url+"comment_id="+d+"&parent_id="+e+"&content="+f+"&user_id="+g,c.jsonP(h,b)},commentlistByHim:function(a,b){var c=this,d=a.user_id,e=a.pageIndex,f=a.pageSize,g={url:c.comment_list_byUser+"user_id="+d+"&pageindex="+e+"&pagesize="+f};$.ajax({type:"GET",url:g.url,dataType:"jsonp",jsonpCallback:"userCommentList",cache:!0,success:function(c){b(c,a)}})},tagsAdd:function(a,b){var c=this,d=a.content,e={url:XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/addLabel?label_name="+d};c.jsonP(e,b)},answerList:function(a,b){var c=this,d=a.ProductId,e=a.askId,f=a.pageindex,g=a.pagesize,h={url:c.question_url+"product_id="+d+"&ask_mode=answer&pageindex="+f+"&pagesize="+g+"&ask_id="+e};c.jsonP(h,b)},answerAdd:function(a,b){var c=this,d=a.ProductId,e=a.askId,f=a.content,g={url:c.question_add+"product_id="+d+"&content="+f+"&ask_mode=answer&ask_id="+e};c.jsonP(g,b)},goodsSetUseful:function(a,b){var c=this,d=a.comment_id,e={url:XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/up?comment_id="+d};c.jsonP(e,b)},goodsSetUnUseful:function(a,b){var c=this,d=a.comment_id,e={url:XIAOMI.GLOBAL_CONFIG.commentApiUrl+"/comment/entry/down?comment_id="+d};c.jsonP(e,b)},revertStr:function(a){var a=String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return encodeURIComponent(a)},normalStr:function(a){return decodeURIComponent(a)}},XIAOMI.goodsComments.init();